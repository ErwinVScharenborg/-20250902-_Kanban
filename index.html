<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Kanban Board</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the scrollbar and drag-and-drop functionality */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .kanban-column {
            min-height: 200px;
        }
        .task-card {
            cursor: grab;
            transition: background-color 0.2s, box-shadow 0.2s;
        }
        .task-card:active {
            cursor: grabbing;
        }
        .dragging {
            opacity: 0.5;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.2), 0 4px 6px -4px rgb(0 0 0 / 0.2);
            transform: rotate(2deg);
        }
        .drag-over {
            border-style: dashed;
            border-color: #4f46e5;
        }
        .column-content::-webkit-scrollbar {
            width: 8px;
        }
        .column-content::-webkit-scrollbar-thumb {
            background-color: #9ca3af;
            border-radius: 10px;
        }
        .column-content::-webkit-scrollbar-track {
            background-color: rgba(0,0,0,0.1);
            border-radius: 10px;
        }
    </style>
</head>
<body class="bg-slate-100 p-4 lg:p-8">

    <div class="mb-6">
        <h1 class="text-3xl font-bold text-slate-800">Project Kanban Board</h1>
        <p class="text-slate-600">Drag and drop tasks to update their status.</p>
    </div>

    <main id="kanban-board" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6">
        
        <!-- Kanban Columns will be injected here by JavaScript -->
        <div id="backlog-col" data-status="Backlog" class="kanban-column bg-amber-100 rounded-lg shadow-sm">
            <h2 class="text-lg font-semibold text-amber-800 p-4 border-b-2 border-amber-200">üóÇÔ∏è Backlog</h2>
            <div class="column-content p-4 space-y-4 overflow-y-auto max-h-[70vh]"></div>
        </div>

        <div id="todo-col" data-status="To do" class="kanban-column bg-rose-100 rounded-lg shadow-sm">
            <h2 class="text-lg font-semibold text-rose-800 p-4 border-b-2 border-rose-200">üìã To Do</h2>
            <div class="column-content p-4 space-y-4 overflow-y-auto max-h-[70vh]"></div>
        </div>

        <div id="doing-col" data-status="Doing" class="kanban-column bg-sky-100 rounded-lg shadow-sm">
            <h2 class="text-lg font-semibold text-sky-800 p-4 border-b-2 border-sky-200">‚è≥ Doing</h2>
            <div class="column-content p-4 space-y-4 overflow-y-auto max-h-[70vh]"></div>
        </div>

        <div id="stuck-col" data-status="Stuck" class="kanban-column bg-red-100 rounded-lg shadow-sm">
            <h2 class="text-lg font-semibold text-red-800 p-4 border-b-2 border-red-200">‚ùó Stuck</h2>
            <div class="column-content p-4 space-y-4 overflow-y-auto max-h-[70vh]"></div>
        </div>

        <div id="done-col" data-status="Done" class="kanban-column bg-green-100 rounded-lg shadow-sm">
            <h2 class="text-lg font-semibold text-green-800 p-4 border-b-2 border-green-200">‚úÖ Done</h2>
            <div class="column-content p-4 space-y-4 overflow-y-auto max-h-[70vh]"></div>
        </div>

    </main>

    <script>
        const tsvData = `Taaknaam;Bucketnaam;Voortgang;Prioriteit;Beschrijving
Checken afspraken Feetneeds door Stein / Everhard;Stuck;Wordt uitgevoerd;Gemiddeld;
Communicatie plan Stakeholders;To do;Niet gestart;Gemiddeld;"Betrekken KCO, via Pascal
Maandelijkse log update o.i.d."
Linken power BI dashboard Planner ;Backlog;Niet gestart;Gemiddeld;
Tekst onder zolen;Stuck;Wordt uitgevoerd;Gemiddeld;
Plan van aanpak Productie opschalen;Stuck;Wordt uitgevoerd;Gemiddeld;"Uitgangspunt: Alles wat we met SLIM kunnen maken moeten we ook kunnen printen.
- Wat zijn we niet aan het printen?
    - Wat kunnen we niet?
        - Hoe weten we wat we niet kunnen?
            - Spelregels / Paulien brief
            - Analyse laatste jaar zolen tov printer capaciteit
        - Hoe vaak komen die dingen voor?
        - Hoe kunnen we dat oplossen?
        - Wat is de prioriteit?
    - Wat doen we niet?
        - Hoe weten we wat we niet doen?
            - Lodewijk vragen overzicht te maken van alle orders betrokken therapeuten sinds pilot.
                - Deze afzetten tegen wat we niet kunnen / spelregels / brief
 
        - Waarom doen we dat niet
        - Hoe kunnen we dat oplossen?
        - Wat is de prioriteit?"
Printer Tests Bjorn;Doing;Wordt uitgevoerd;Gemiddeld;
2 hardheden in een zool ;Done;Voltooid;Gemiddeld;aantonen dat de FeedNeeds printers dit hanteren
Capaciteit pilot bepalen;Done;Voltooid;Gemiddeld;
Opstarten Pilot (Strategisch Stein);Done;Voltooid;Gemiddeld;
Spelregels pilot doorlopen;Done;Voltooid;Gemiddeld;
Feetneeds printers up and running;Done;Voltooid;Belangrijk;
Eigen printers - afhaal systemen onderzoek;Doing;Wordt uitgevoerd;Gemiddeld;
Herdefinie√´ren spelregels pilot n.a.v. onderzoke;Doing;Wordt uitgevoerd;Gemiddeld;
toetsings criteria opstellen materiaal;Backlog;Niet gestart;Gemiddeld;
toetsings criteria opstellen printers;Backlog;Niet gestart;Gemiddeld;
Opzetten producttesten lab setting;To do;Niet gestart;Gemiddeld;materiaal testen opzetten om de zolen te toetsen op materiaaleigenschappen
Voron nieuwe kop Bjorn;Doing;Wordt uitgevoerd;Gemiddeld;
Zolen via SLIM ontvangen van Jeroen / Bas;To do;Niet gestart;Gemiddeld;
Printen zolen behandelaren Pilot;Done;Voltooid;Gemiddeld;
Opstarten Pilot (Operationeel Paulien);Done;Voltooid;Gemiddeld;
+0.5mm print dikte slicer ;Done;Voltooid;Gemiddeld;Contact feedneeds over hoogte afwijking in geslicede bestanden
2mm printzolen ;Done;Voltooid;Gemiddeld;Niet gelukt op de feetneeds printers - 90 graden printers lijken goed
Spelregels ontvangen van Rick;Done;Voltooid;Gemiddeld;
Samenwerkingspartner selecteren;Done;Voltooid;Gemiddeld;
Printer Creality testen;Done;Voltooid;Gemiddeld;`;

        function parseData(data) {
            const lines = data.trim().split('\n');
            const headers = lines.shift().split(';').map(h => h.trim());
            const tasks = lines.map((line, index) => {
                const values = line.split(';');
                let task = {};
                headers.forEach((header, i) => {
                    // Handle multi-line descriptions by joining remaining parts
                    if (i === headers.length - 1) {
                         task[header] = values.slice(i).join(';').replace(/^"|"$/g, '').trim();
                    } else {
                         task[header] = (values[i] || '').trim();
                    }
                });
                task.id = `task-${Date.now()}-${index}`;
                return task;
            });
            return tasks;
        }

        function getPriorityBadge(priority) {
            if (!priority) return '';
            let colorClasses = 'bg-slate-200 text-slate-700';
            if (priority.toLowerCase() === 'belangrijk') {
                colorClasses = 'bg-red-500 text-white';
            } else if (priority.toLowerCase() === 'gemiddeld') {
                colorClasses = 'bg-amber-400 text-white';
            }
            return `<span class="text-xs font-semibold px-2 py-1 rounded-full ${colorClasses}">${priority}</span>`;
        }

        function createTaskCard(task) {
            const card = document.createElement('div');
            card.id = task.id;
            card.className = 'task-card bg-white p-3 rounded-md shadow-sm border border-slate-200';
            card.draggable = true;

            const priorityBadge = getPriorityBadge(task.Prioriteit);
            const descriptionHTML = task.Beschrijving ? `<p class="text-sm text-slate-600 mt-2 whitespace-pre-wrap">${task.Beschrijving}</p>` : '';

            card.innerHTML = `
                <div class="flex justify-between items-start">
                    <h3 class="font-medium text-slate-800 pr-2">${task.Taaknaam}</h3>
                    ${priorityBadge}
                </div>
                ${descriptionHTML}
            `;
            return card;
        }

        function renderBoard() {
            const tasks = parseData(tsvData);
            const columnMap = {
                'backlog': document.querySelector('#backlog-col .column-content'),
                'to do': document.querySelector('#todo-col .column-content'),
                'doing': document.querySelector('#doing-col .column-content'),
                'stuck': document.querySelector('#stuck-col .column-content'),
                'done': document.querySelector('#done-col .column-content'),
            };

            tasks.forEach(task => {
                const card = createTaskCard(task);
                const status = (task.Bucketnaam || 'Backlog').toLowerCase();
                const column = columnMap[status];

                if (column) {
                    column.appendChild(card);
                } else {
                    console.warn(`Unknown status "${task.Bucketnaam}" for task "${task.Taaknaam}". Placing in Backlog.`);
                    columnMap['backlog'].appendChild(card);
                }
            });

            setupDragAndDrop();
        }

        function setupDragAndDrop() {
            const cards = document.querySelectorAll('.task-card');
            const columns = document.querySelectorAll('.kanban-column');
            let draggedItem = null;

            cards.forEach(card => {
                card.addEventListener('dragstart', (e) => {
                    draggedItem = e.target;
                    setTimeout(() => e.target.classList.add('dragging'), 0);
                });

                card.addEventListener('dragend', () => {
                    draggedItem.classList.remove('dragging');
                    draggedItem = null;
                });
            });

            columns.forEach(column => {
                column.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    if (!column.classList.contains('drag-over')) {
                         column.classList.add('drag-over', 'border-2');
                    }
                });
                
                column.addEventListener('dragleave', (e) => {
                    column.classList.remove('drag-over', 'border-2');
                });

                column.addEventListener('drop', (e) => {
                    e.preventDefault();
                    column.classList.remove('drag-over', 'border-2');
                    const contentArea = column.querySelector('.column-content');
                    if (draggedItem && contentArea) {
                        contentArea.appendChild(draggedItem);
                    }
                });
            });
        }
        
        document.addEventListener('DOMContentLoaded', renderBoard);
    </script>

</body>
</html>

